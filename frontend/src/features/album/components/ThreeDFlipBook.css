/* =========================================================================
   Flipix Engine Base Styles (Exact Replica)
   ========================================================================= */

.flipbook-wrapper {
    /* To absolutely center the active book just like flipix does */
    width: 100%;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    position: relative;
}

.book {
    /* Flipbook's original centering logic */
    position: absolute;
    top: 50%;
    left: 50%;
    width: 296px;
    aspect-ratio: 1.5;
    transition-duration: 1s;
    perspective: 1500px;
    transform: translate(-50%, -50%) rotateX(-5deg);
}

.book.portrait {
    width: 148px;
}

.front-cover,
.back-cover {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 0 15px 15px 0;
    box-shadow: 0 0 5px rgb(41, 41, 41);
    transform-origin: left;
}

/* Covers only span 1 page, so they use 100% width, not 200% */
.front-cover img,
.back-cover img {
    width: 100%;
    object-fit: cover;
}

.front-cover {
    z-index: var(--reverse-count);
    transition: transform 1.5s;
    /* animation: turnEffect 2s ease-in-out; */
}

.front-cover.hint-anim {
    animation: turnEffect 2.5s ease-in-out infinite;
}

.back-cover {
    transition: transform 1.5s, z-index 0.5s 0.5s;
    z-index: var(--reverse-count);
}

.page {
    position: absolute;
    transform-origin: left;
    transform-style: preserve-3d;
    transform: rotateY(-20deg);
}

.inner.page {
    width: 100%;
    height: 100%;
}

.page .blank {
    background: #FAFAFA;
}

.page.first-half {
    transition: transform 1.5s;
}

.page.last-half {
    transition: transform 1.5s, z-index 0.5s 0.5s;
}

/* FLIPIX SPECIFIC: Images inside pages */
.inner.page img:not(.single-img) {
    position: absolute;
    height: 100% !important;
    width: 200% !important;
    /* forces the image to map across 2 full pages */
    max-width: none !important;
    max-height: none !important;
    object-fit: fill !important;
    /* ensures the 32:9 image stretches exactly to fill the 200% width container */
}

.page img.single-img {
    position: absolute;
    width: 100% !important;
    height: 100% !important;
    max-width: none !important;
    object-fit: fill !important;
    right: auto !important;
    left: auto !important;
}

.inner.page .front-page img:not(.single-img) {
    right: 0 !important;
    /* Align to the right edge for the right page of a spread */
}

.inner.page .back-page img:not(.single-img) {
    left: 0 !important;
    /* Align to the left edge for the left page of a spread */
}

.front-page,
.back-page {
    background: #FAFAFA;
    position: absolute;
    width: 100%;
    height: 100%;
    overflow: hidden;
    backface-visibility: hidden;
    border-radius: 10px;

}

.inner.page .front-page {
    border-radius: 0 10px 10px 0;
}

.inner.page .back-page {
    border-radius: 10px 0 0 10px;
}

.back-page {
    transform: rotateY(180deg);
    z-index: 99;
}

/* Flipix originally uses these labels, keeping for compatibility if ever needed */
.page label {
    font-size: 14px;
    font-weight: 700;
    -webkit-text-stroke: 1px black;
    position: absolute;
    bottom: 0;
    opacity: 0.8;
}

.front-page label {
    right: 0;
}

.back-page label {
    left: 0;
}

.book .page {
    z-index: var(--reverse-count);
}

/* EXACT FLIPIX CENTERING LOGIC */
.book.open {
    /* Desktop flipix uses this specific translation to center the *opened* book */
    transform: translate(0%, -50%) rotateZ(-2deg) rotateX(-5deg);
}

.book.open.portrait {
    transform: translate(-25%, -50%) rotateZ(-2deg) rotateX(-5deg);
}

.book.open .front-cover {
    transition: transform 1.5s, z-index 0.5s 0.5s;
}

.book.open .page {
    box-shadow: -1px 0px 4px 0px rgba(99, 98, 98, 0.3);
}

.book .page.turn {
    transform: rotateY(-175deg);
    z-index: var(--count);
}

.book .page.first-half.turn {
    transition: transform 1.5s, z-index 0.5s 0.5s;
}

.book .page.last-half.turn {
    transition: transform 1.5s;
}

.book .back-cover.turn {
    transition: transform 1.5s;
}

.book.close {
    /* Translate +50% shifts the spine to the right, perfectly centering the closed back cover which spans leftwards */
    transform: translate(50%, -50%) rotateZ(0deg) rotateX(-5deg);
}

.book.close.portrait {
    transform: translate(25%, -50%) rotateZ(0deg) rotateX(-5deg);
}

@keyframes turnEffect {
    0% {
        transform: rotateY(-20deg);
    }

    10% {
        transform: rotateY(-20deg);
    }

    60% {
        transform: rotateY(-40deg);
    }

    100% {
        transform: rotateY(-20deg);
    }
}

/* Flipix Media Query */
@media only screen and (min-width: 1100px) {
    .book {
        width: 500px;
        /* Note: For vertical center, flipix does margin: 100px auto 0 auto.
           But to keep it true 100svh centered without scrolling, we override and keep translate */
        margin: 0;
    }

    .book.open {
        /* Open needs to shift right by EXACTLY half its width (250px) to appear centered when spread is 1000px wide */
        transform: translate(0%, -50%) rotateZ(-2deg) rotateX(-5deg);
    }

    .book.portrait {
        width: 400px;
    }

    .book.open.portrait {
        transform: translate(-25%, -50%) rotateZ(-2deg) rotateX(-5deg);
    }

    .book.close.portrait {
        transform: translate(-50%, -50%);
    }

    .page label {
        font-size: 18px;
    }
}


/* =========================================================================
   React Wrapper Controls
   ========================================================================= */

.floating-controls {
    position: fixed;
    bottom: 24px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(20, 20, 20, 0.85);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    padding: 8px 16px;
    border-radius: 9999px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
    z-index: 100;
}

.control-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: rgba(255, 255, 255, 0.8);
    transition: all 0.2s ease;
    border: none;
    background: transparent;
    cursor: pointer;
}

.control-btn:hover:not(:disabled) {
    color: white;
    background: rgba(255, 255, 255, 0.1);
}

.control-btn:disabled {
    opacity: 0.3;
    cursor: not-allowed;
}

.control-btn.play-active {
    color: #EAB308;
    background: rgba(234, 179, 8, 0.1);
}